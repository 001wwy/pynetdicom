

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pynetdicom3.applicationentity &mdash; pynetdicom3 0.9.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/pynetdicom3.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pynetdicom3.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pynetdicom3
          

          
            
            <img src="../../_static/pydicom_flat_black.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.9.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ae_intro.html">ApplicationEntity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../assoc_intro.html">Introduction to Association</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Package documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pynetdicom3</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pynetdicom3.applicationentity</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pynetdicom3.applicationentity</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The main user class, represents a DICOM Application Entity</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">from</span> <span class="nn">inspect</span> <span class="k">import</span> <span class="n">isclass</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">select</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">from</span> <span class="nn">struct</span> <span class="k">import</span> <span class="n">pack</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">pydicom.uid</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">ExplicitVRLittleEndian</span><span class="p">,</span> <span class="n">ImplicitVRLittleEndian</span><span class="p">,</span> <span class="n">ExplicitVRBigEndian</span><span class="p">,</span> <span class="n">UID</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">pynetdicom3.association</span> <span class="k">import</span> <span class="n">Association</span>
<span class="kn">from</span> <span class="nn">pynetdicom3.presentation</span> <span class="k">import</span> <span class="n">PresentationContext</span>
<span class="kn">from</span> <span class="nn">pynetdicom3.utils</span> <span class="k">import</span> <span class="n">validate_ae_title</span>


<span class="k">def</span> <span class="nf">setup_logger</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Setup the logger.&quot;&quot;&quot;</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;pynetdicom3&#39;</span><span class="p">)</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
    <span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%(levelname).1s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logger</span>


<span class="n">LOGGER</span> <span class="o">=</span> <span class="n">setup_logger</span><span class="p">()</span>


<div class="viewcode-block" id="ApplicationEntity"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity">[docs]</a><span class="k">class</span> <span class="nc">ApplicationEntity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents a DICOM Application Entity (AE).</span>

<span class="sd">    An AE may be either a server (Service Class Provider or SCP) or a client</span>
<span class="sd">    (Service Class User or SCU).</span>


<span class="sd">    **SCP**</span>

<span class="sd">    To use an AE as an SCP, you need to specify the listen `port` number that</span>
<span class="sd">    peer AE SCUs can use to request Associations over, as well as the SOP</span>
<span class="sd">    Classes that the SCP supports (`scp_sop_class`). If the SCP is being used</span>
<span class="sd">    for anything other than the C-ECHO DIMSE service you also need to implement</span>
<span class="sd">    the required callbacks.</span>

<span class="sd">    The SCP can then be started using `ApplicationEntity.start()`</span>

<span class="sd">    **C-STORE SCP Example**</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">            from pynetdicom3 import AE, StorageSOPClassList</span>

<span class="sd">            # Specify the listen port and which SOP Classes are supported</span>
<span class="sd">            ae = AE(port=11112, scp_sop_class=StorageSOPClassList)</span>

<span class="sd">            # Define the callback for receiving a C-STORE request</span>
<span class="sd">            def on_c_store(dataset):</span>
<span class="sd">                # Insert your C-STORE handling code here</span>

<span class="sd">                # Must return a valid C-STORE status - 0x0000 is Success</span>
<span class="sd">                return 0x0000</span>

<span class="sd">            ae.on_c_store = on_c_store</span>

<span class="sd">            # Start the SCP</span>
<span class="sd">            ae.start()</span>

<span class="sd">    **SCU**</span>

<span class="sd">    To use an AE as an SCU you only need to specify the SOP Classes that the SCU</span>
<span class="sd">    supports (`scu_sop_class`) and then call `ApplicationEntity.associate(addr,</span>
<span class="sd">    port)` where *addr* and *port* are the TCP/IP address and the listen port</span>
<span class="sd">    number of the peer SCP, respectively.</span>

<span class="sd">    Once the Association is established you can then request any of the DIMSE-C</span>
<span class="sd">    or DIMSE-N services.</span>

<span class="sd">    **C-ECHO SCU Example**</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">            from pynetdicom3 import AE, VerificationSOPClass</span>

<span class="sd">            # Specify which SOP Classes are supported as an SCU</span>
<span class="sd">            ae = AE(scu_sop_class=[VerificationSOPClass])</span>

<span class="sd">            # Request an association with a peer SCP</span>
<span class="sd">            assoc = ae.associate(addr=192.168.2.1, port=104)</span>

<span class="sd">            if assoc.is_established:</span>
<span class="sd">                status = assoc.send_c_echo()</span>

<span class="sd">                # Release the association</span>
<span class="sd">                assoc.Release()</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    acse_timeout : int or float or None</span>
<span class="sd">        The maximum amount of time (in seconds) to wait for association related</span>
<span class="sd">        messages. A value of None means no timeout. (default: 60)</span>
<span class="sd">    active_associations : list of pynetdicom3.association.Association</span>
<span class="sd">        The currently active associations between the local and peer AEs</span>
<span class="sd">    address : str</span>
<span class="sd">        The local AE&#39;s TCP/IP address</span>
<span class="sd">    ae_title : str or bytes</span>
<span class="sd">        The local AE&#39;s title</span>
<span class="sd">    client_socket : socket.socket</span>
<span class="sd">        The socket used for connections with peer AEs</span>
<span class="sd">    dimse_timeout : int or float or None</span>
<span class="sd">        The maximum amount of time (in seconds) to wait for DIMSE related</span>
<span class="sd">        messages. A value of None means no timeout. (default: None)</span>
<span class="sd">    network_timeout : int or float or None</span>
<span class="sd">        The maximum amount of time (in seconds) to wait for network messages.</span>
<span class="sd">        A value of None means no timeout. (default: None)</span>
<span class="sd">    maximum_associations : int</span>
<span class="sd">        The maximum number of simultaneous associations (default: 2)</span>
<span class="sd">    maximum_pdu_size : int</span>
<span class="sd">        The maximum PDU receive size in bytes. A value of 0 means there is no</span>
<span class="sd">        maximum size (default: 16382)</span>
<span class="sd">    port : int</span>
<span class="sd">        The local AE&#39;s listen port number when acting as an SCP or connection</span>
<span class="sd">        port when acting as an SCU. A value of 0 indicates that the operating</span>
<span class="sd">        system should choose the port.</span>
<span class="sd">    presentation_contexts_scu : List of pynetdicom3.utils.PresentationContext</span>
<span class="sd">        The presentation context list when acting as an SCU (SCU only)</span>
<span class="sd">    presentation_contexts_scp : List of pynetdicom3.utils.PresentationContext</span>
<span class="sd">        The presentation context list when acting as an SCP (SCP only)</span>
<span class="sd">    require_calling_aet : str</span>
<span class="sd">        If not empty str, the calling AE title must match `require_calling_aet`</span>
<span class="sd">        (SCP only)</span>
<span class="sd">    require_called_aet : str</span>
<span class="sd">        If not empty str the called AE title must match `required_called_aet`</span>
<span class="sd">        (SCP only)</span>
<span class="sd">    scu_supported_sop : List of pydicom.uid.UID</span>
<span class="sd">        The SOP Classes supported when acting as an SCU (SCU only)</span>
<span class="sd">    scp_supported_sop : List of pydicom.uid.UID</span>
<span class="sd">        The SOP Classes supported when acting as an SCP (SCP only)</span>
<span class="sd">    transfer_syntaxes : List of pydicom.uid.UID</span>
<span class="sd">        The supported transfer syntaxes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=too-many-instance-attributes,too-many-public-methods</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ae_title</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;PYNETDICOM&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scu_sop_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">scp_sop_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transfer_syntax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">bind_addr</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new Application Entity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ae_title : str, optional</span>
<span class="sd">            The AE title of the Application Entity (default: PYNETDICOM)</span>
<span class="sd">        port : int, optional</span>
<span class="sd">            The port number to listen for connections on when acting as an SCP</span>
<span class="sd">            (default: the first available port)</span>
<span class="sd">        bind_addr : str, optional</span>
<span class="sd">            The network interface to listen to.</span>
<span class="sd">            (default: all availabel network interfaces on the machine)</span>
<span class="sd">        scu_sop_class : list of pydicom.uid.UID or list of str or list of</span>
<span class="sd">        pynetdicom3.sop_class.ServiceClass subclasses, optional</span>
<span class="sd">            List of the supported SOP Class UIDs when running as an SCU.</span>
<span class="sd">            Either `scu_sop_class` or `scp_sop_class` must have values</span>
<span class="sd">        scp_sop_class : list of pydicom.uid.UID or list of UID strings or list</span>
<span class="sd">        of pynetdicom3.sop_class.ServiceClass subclasses, optional</span>
<span class="sd">            List of the supported SOP Class UIDs when running as an SCP.</span>
<span class="sd">            Either scu_`sop_class` or `scp_sop_class` must have values</span>
<span class="sd">        transfer_syntax : list of pydicom.uid.UID or list of str or list of</span>
<span class="sd">        pynetdicom3.sop_class.ServiceClass subclasses, optional</span>
<span class="sd">            List of supported Transfer Syntax UIDs (default: Explicit VR Little</span>
<span class="sd">            Endian, Implicit VR Little Endian, Explicit VR Big Endian)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">node</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind_addr</span> <span class="o">=</span> <span class="n">bind_addr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ae_title</span> <span class="o">=</span> <span class="n">ae_title</span>

        <span class="c1"># Avoid dangerous default values</span>
        <span class="k">if</span> <span class="n">transfer_syntax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">transfer_syntax</span> <span class="o">=</span> <span class="p">[</span><span class="n">ExplicitVRLittleEndian</span><span class="p">,</span>
                               <span class="n">ImplicitVRLittleEndian</span><span class="p">,</span>
                               <span class="n">ExplicitVRBigEndian</span><span class="p">]</span>

        <span class="c1"># Make sure that one of scu_sop_class/scp_sop_class is not empty</span>
        <span class="k">if</span> <span class="n">scu_sop_class</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scp_sop_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No supported SOP Class UIDs supplied during &quot;</span>
                             <span class="s2">&quot;ApplicationEntity instantiation&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scu_supported_sop</span> <span class="o">=</span> <span class="n">scu_sop_class</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scp_supported_sop</span> <span class="o">=</span> <span class="n">scp_sop_class</span> <span class="ow">or</span> <span class="p">[]</span>

        <span class="c1"># The transfer syntax(es) available to the AE</span>
        <span class="c1">#   At a minimum this must be ... FIXME</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transfer_syntaxes</span> <span class="o">=</span> <span class="n">transfer_syntax</span>

        <span class="c1"># The user may require the use of Extended Negotiation items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extended_negotiation</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># List of active association objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Default maximum simultaneous associations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximum_associations</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="c1"># Default maximum PDU receive size (in bytes)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maximum_pdu_size</span> <span class="o">=</span> <span class="mi">16382</span>

        <span class="c1"># Default timeouts - None means no timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Require Calling/Called AE titles to match if value is non-empty str</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">require_called_aet</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_build_presentation_contexts</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Used to terminate AE when running as an SCP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="ApplicationEntity.start"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the AE as an SCP.</span>

<span class="sd">        When running the AE as an SCP this needs to be called to start the main</span>
<span class="sd">        loop, it listens for connections on `local_socket` and if they request</span>
<span class="sd">        association starts a new Association thread</span>

<span class="sd">        Successful associations get added to `active_associations`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If the SCP has no supported SOP Classes then there&#39;s no point</span>
        <span class="c1">#   running as a server</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scp_supported_sop</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;AE is running as an SCP but no supported SOP classes &quot;</span>
                         <span class="s2">&quot;for use with the SCP have been included during&quot;</span>
                         <span class="s2">&quot;ApplicationEntity initialisation or by setting the &quot;</span>
                         <span class="s2">&quot;scp_supported_sop attribute&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AE is running as an SCP but no SCP SOP classes &quot;</span>
                             <span class="s2">&quot;have been supplied.&quot;</span><span class="p">)</span>

        <span class="c1"># Bind the local_socket to the specified listen port</span>
        <span class="c1">#try:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bind_socket</span><span class="p">()</span>
        <span class="c1">#except OSError:</span>
        <span class="c1">#    self._quit = True</span>
        <span class="c1">#    self.stop()</span>
        <span class="c1">#    return</span>

        <span class="n">no_loops</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># #60: Required so we don&#39;t max out the CPU</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="c1"># Monitor client_socket for association requests and</span>
                <span class="c1">#   appends any associations to self.active_associations</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_monitor_socket</span><span class="p">()</span>

                <span class="c1"># Delete dead associations</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cleanup_associations</span><span class="p">()</span>

                <span class="c1"># Every 50 loops run the garbage collection</span>
                <span class="k">if</span> <span class="n">no_loops</span> <span class="o">%</span> <span class="mi">51</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
                    <span class="n">no_loops</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="n">no_loops</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_bind_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set up and bind the SCP socket.</span>

<span class="sd">        AE.start(): Set up and bind the socket. Separated out from start() to</span>
<span class="sd">        enable better unit testing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The socket to listen for connections on, port is always specified</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">bind_addr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
        <span class="c1"># Listen for connections made to the socket, the backlog argument</span>
        <span class="c1">#   specifies the maximum number of queued connections.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_build_presentation_contexts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Build the presentation context list.</span>

<span class="sd">        Build presentation context list to be:</span>
<span class="sd">        * sent to remote AE when requesting association</span>
<span class="sd">          (presentation_contexts_scu)</span>
<span class="sd">        * used to decide whether to accept or reject when remote AE</span>
<span class="sd">          requests association (presentation_contexts_scp)</span>

<span class="sd">        See PS3.8 Sections 7.1.1.13 and 9.3.2.2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presentation_contexts_scu</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presentation_contexts_scp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">[</span><span class="n">pc_output</span><span class="p">,</span> <span class="n">sop_input</span><span class="p">]</span> <span class="ow">in</span> \
                    <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation_contexts_scu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scu_supported_sop</span><span class="p">],</span>
                     <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation_contexts_scp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scp_supported_sop</span><span class="p">]]:</span>

            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">sop_class</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sop_input</span><span class="p">):</span>
                <span class="c1"># Must be an odd integer between 1 and 255</span>
                <span class="n">presentation_context_id</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">sop_class</span>

                <span class="c1"># Add the Presentation Context Definition Item</span>
                <span class="c1"># If we have too many Items, warn and skip the rest</span>
                <span class="k">if</span> <span class="n">presentation_context_id</span> <span class="o">&lt;</span> <span class="mi">255</span><span class="p">:</span>
                    <span class="n">pc_item</span> <span class="o">=</span> <span class="n">PresentationContext</span><span class="p">()</span>
                    <span class="n">pc_item</span><span class="o">.</span><span class="n">context_id</span> <span class="o">=</span> <span class="n">presentation_context_id</span>
                    <span class="n">pc_item</span><span class="o">.</span><span class="n">abstract_syntax</span> <span class="o">=</span> <span class="n">abstract_syntax</span>
                    <span class="n">pc_item</span><span class="o">.</span><span class="n">transfer_syntax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer_syntaxes</span><span class="p">[:]</span>

                    <span class="n">pc_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc_item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;More than 126 supported SOP Classes have &quot;</span>
                                   <span class="s2">&quot;been supplied to the Application Entity, &quot;</span>
                                   <span class="s2">&quot;but the Presentation Context Definition ID &quot;</span>
                                   <span class="s2">&quot;can only be an odd integer between 1 and &quot;</span>
                                   <span class="s2">&quot;255. The remaining SOP Classes will not be &quot;</span>
                                   <span class="s2">&quot;included&quot;</span><span class="p">)</span>
                    <span class="k">break</span>

    <span class="k">def</span> <span class="nf">_monitor_socket</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Monitor the local socket for connections.</span>

<span class="sd">        AE.start(): Monitors the local socket to see if anyone tries to connect</span>
<span class="sd">        and if so, creates a new association. Separated out from start() to</span>
<span class="sd">        enable better unit testing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># FIXME: this needs to be dealt with properly</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">read_list</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># If theres a connection</span>
        <span class="k">if</span> <span class="n">read_list</span><span class="p">:</span>
            <span class="n">client_socket</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="n">client_socket</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span>
                                     <span class="n">socket</span><span class="o">.</span><span class="n">SO_RCVTIMEO</span><span class="p">,</span>
                                     <span class="n">pack</span><span class="p">(</span><span class="s1">&#39;ll&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

            <span class="c1"># Create a new Association</span>
            <span class="c1"># Association(local_ae, local_socket=None, max_pdu=16382)</span>
            <span class="n">assoc</span> <span class="o">=</span> <span class="n">Association</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">client_socket</span><span class="o">=</span><span class="n">client_socket</span><span class="p">,</span>
                                <span class="n">max_pdu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maximum_pdu_size</span><span class="p">,</span>
                                <span class="n">acse_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span><span class="p">,</span>
                                <span class="n">dimse_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span><span class="p">)</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assoc</span><span class="p">)</span>

<div class="viewcode-block" id="ApplicationEntity.cleanup_associations"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.cleanup_associations">[docs]</a>    <span class="k">def</span> <span class="nf">cleanup_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove dead associations.</span>

<span class="sd">        AE.start(): Removes any dead associations from self.active_associations</span>
<span class="sd">        by checking to see if the association thread is still alive. Separated</span>
<span class="sd">        out from start() to enable better unit testing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We can use threading.enumerate() to list all alive threads</span>
        <span class="c1">#   assoc.is_alive() is inherited from threading.thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span> <span class="o">=</span> \
            <span class="p">[</span><span class="n">assoc</span> <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span> <span class="k">if</span> <span class="n">assoc</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()]</span></div>

<div class="viewcode-block" id="ApplicationEntity.stop"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop the SCP.</span>

<span class="sd">        When running as an SCP, calling stop() will kill all associations,</span>
<span class="sd">        close the listen socket and quit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_quit</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">abort</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">local_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApplicationEntity.quit"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.quit">[docs]</a>    <span class="k">def</span> <span class="nf">quit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop the SCP.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApplicationEntity.associate"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.associate">[docs]</a>    <span class="k">def</span> <span class="nf">associate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">ae_title</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;ANY-SCP&#39;</span><span class="p">,</span>
                  <span class="n">max_pdu</span><span class="o">=</span><span class="mi">16382</span><span class="p">,</span> <span class="n">ext_neg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attempts to associate with a remote application entity</span>

<span class="sd">        When requesting an association the local AE is acting as an SCU. The</span>
<span class="sd">        Association thread is returned whether or not the association is</span>
<span class="sd">        accepted and should be checked using Association.is_established before</span>
<span class="sd">        sending any messages.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        addr : str</span>
<span class="sd">            The peer AE&#39;s TCP/IP address (IPv4)</span>
<span class="sd">        port : int</span>
<span class="sd">            The peer AE&#39;s listen port number</span>
<span class="sd">        ae_title : str, optional</span>
<span class="sd">            The peer AE&#39;s title</span>
<span class="sd">        max_pdu : int, optional</span>
<span class="sd">            The maximum PDV receive size in bytes to use when negotiating the</span>
<span class="sd">            association</span>
<span class="sd">        ext_neg : List of UserInformation objects, optional</span>
<span class="sd">            Used if extended association negotiation is required</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        assoc : pynetdicom3.association.Association</span>
<span class="sd">            The Association thread</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;addr&#39; must be a valid IPv4 string&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;port&#39; must be a valid port number&quot;</span><span class="p">)</span>

        <span class="n">peer_ae</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ae_title&#39;</span> <span class="p">:</span> <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">ae_title</span><span class="p">),</span>
                   <span class="s1">&#39;address&#39;</span> <span class="p">:</span> <span class="n">addr</span><span class="p">,</span>
                   <span class="s1">&#39;port&#39;</span> <span class="p">:</span> <span class="n">port</span><span class="p">}</span>

        <span class="c1"># Associate</span>
        <span class="n">assoc</span> <span class="o">=</span> <span class="n">Association</span><span class="p">(</span><span class="n">local_ae</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">peer_ae</span><span class="o">=</span><span class="n">peer_ae</span><span class="p">,</span>
                            <span class="n">acse_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span><span class="p">,</span>
                            <span class="n">dimse_timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span><span class="p">,</span>
                            <span class="n">max_pdu</span><span class="o">=</span><span class="n">max_pdu</span><span class="p">,</span>
                            <span class="n">ext_neg</span><span class="o">=</span><span class="n">ext_neg</span><span class="p">)</span>
        <span class="n">assoc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="c1"># Endlessly loops while the Association negotiation is taking place</span>
        <span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">assoc</span><span class="o">.</span><span class="n">is_established</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">assoc</span><span class="o">.</span><span class="n">is_rejected</span> <span class="ow">and</span>
               <span class="ow">not</span> <span class="n">assoc</span><span class="o">.</span><span class="n">is_aborted</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">assoc</span><span class="o">.</span><span class="n">dul</span><span class="o">.</span><span class="n">_kill_thread</span><span class="p">):</span>
            <span class="c1"># Program loops here endlessly sometimes</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

        <span class="c1"># If the Association was established</span>
        <span class="k">if</span> <span class="n">assoc</span><span class="o">.</span><span class="n">is_established</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">assoc</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">assoc</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Prints out the attribute values and status for the AE &quot;&quot;&quot;</span>
        <span class="n">str_out</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;Application Entity &#39;</span><span class="si">{0!s}</span><span class="s2">&#39; on </span><span class="si">{1!s}</span><span class="s2">:</span><span class="si">{2!s}</span><span class="se">\n</span><span class="s2">&quot;</span> \
                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ae_title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Available Transfer Syntax(es):</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">syntax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer_syntaxes</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">syntax</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Supported SOP Classes (SCU):</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scu_supported_sop</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">None</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">sop_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scu_supported_sop</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sop_class</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Supported SOP Classes (SCP):</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">scp_supported_sop</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">None</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">sop_class</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scp_supported_sop</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sop_class</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  ACSE timeout: </span><span class="si">{0!s}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span><span class="p">)</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  DIMSE timeout: </span><span class="si">{0!s}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span><span class="p">)</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Network timeout: </span><span class="si">{0!s}</span><span class="s2"> s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_called_aet</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Required calling AE title: </span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span> \
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">require_calling_aet</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">require_called_aet</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;  Required called AE title: </span><span class="si">{0!s}</span><span class="se">\n</span><span class="s2">&quot;</span> \
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">require_called_aet</span><span class="p">)</span>

        <span class="n">str_out</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># Association information</span>
        <span class="n">str_out</span> <span class="o">+=</span> <span class="s1">&#39;  Association(s): </span><span class="si">{0!s}</span><span class="s1">/</span><span class="si">{1!s}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                   <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">maximum_associations</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">str_out</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Peer: </span><span class="si">{0!s}</span><span class="s1"> on </span><span class="si">{1!s}</span><span class="s1">:</span><span class="si">{2!s}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                       <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">assoc</span><span class="o">.</span><span class="n">peer_ae</span><span class="p">[</span><span class="s1">&#39;ae_title&#39;</span><span class="p">],</span>
                               <span class="n">assoc</span><span class="o">.</span><span class="n">peer_ae</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">],</span>
                               <span class="n">assoc</span><span class="o">.</span><span class="n">peer_ae</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">str_out</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">acse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the ACSE timeout.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span>

    <span class="nd">@acse_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">acse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the ACSE timeout.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;acse_timeout set to 60 seconds&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_acse_timeout</span> <span class="o">=</span> <span class="mi">60</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">acse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">acse</span><span class="o">.</span><span class="n">acse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acse_timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ae_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the AE title.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ae_title</span>

    <span class="nd">@ae_title</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ae_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the AE title.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : bytes</span>
<span class="sd">            The AE title to use for the local Application Entity. Leading and</span>
<span class="sd">            trailing spaces are non-significant.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ae_title</span> <span class="o">=</span> <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dimse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the DIMSE timeout.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span>

    <span class="nd">@dimse_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dimse_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the DIMSE timeout.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;dimse_timeout set to never expire&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dimse_timeout</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">dimse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">dimse</span><span class="o">.</span><span class="n">dimse_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimse_timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">network_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the network timeout.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span>

    <span class="nd">@network_timeout</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">network_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the network timeout.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;network_timeout set to never expire&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_network_timeout</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_associations</span><span class="p">:</span>
            <span class="n">assoc</span><span class="o">.</span><span class="n">dul</span><span class="o">.</span><span class="n">dul_timeout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">network_timeout</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maximum_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the number of maximum associations.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_associations</span>

    <span class="nd">@maximum_associations</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">maximum_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the number of maximum associations.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_associations</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;maximum_associations set to 1&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_associations</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">maximum_pdu_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the maximum PDU size.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_pdu_size</span>

    <span class="nd">@maximum_pdu_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">maximum_pdu_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the maximum PDU size.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="c1"># Bounds and type checking of the received maximum length of the</span>
        <span class="c1">#   variable field of P-DATA-TF PDUs (in bytes)</span>
        <span class="c1">#   * Must be numerical, greater than or equal to 0 (0 indicates</span>
        <span class="c1">#       no maximum length (PS3.8 Annex D.1.1)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_pdu_size</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;maximum_pdu_size set to 16382&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">port</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the port number.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_port</span>

    <span class="nd">@port</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the port number.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;AE port number must be an integer greater then &quot;</span>
                             <span class="s2">&quot;or equal to 0&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">require_calling_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the required calling AE title as a length 16 bytes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_require_calling_aet</span>

    <span class="nd">@require_calling_aet</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">require_calling_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ae_title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the required calling AE title.</span>

<span class="sd">        When an Association request is received the value of the &#39;Calling AE</span>
<span class="sd">        Title&#39; supplied by the peer will be compared with the set value and</span>
<span class="sd">        if they don&#39;t match the association will be rejected. If the set value</span>
<span class="sd">        is an empty bytes then the &#39;Calling AE Title&#39; will not be checked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ae_title : bytes</span>
<span class="sd">            If not empty then any association requests that supply a</span>
<span class="sd">            Calling AE Title value that does not match `ae_title` will be</span>
<span class="sd">            rejected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ae_title</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_calling_aet</span> <span class="o">=</span> <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">ae_title</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_calling_aet</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">require_called_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the required called AE title as a length 16 bytes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_require_called_aet</span>

    <span class="nd">@require_called_aet</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">require_called_aet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ae_title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the required called AE title.</span>

<span class="sd">        When an Association request is received the value of the &#39;Called AE</span>
<span class="sd">        Title&#39; supplied by the peer will be compared with the set value and</span>
<span class="sd">        if they don&#39;t match the association will be rejected. If the set value</span>
<span class="sd">        is an empty bytes then the &#39;Called AE Title&#39; will not be checked.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ae_title : bytes</span>
<span class="sd">            If not empty then any association requests that supply a</span>
<span class="sd">            Called AE Title value that does not match `ae_title` will be</span>
<span class="sd">            rejected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ae_title</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_called_aet</span> <span class="o">=</span> <span class="n">validate_ae_title</span><span class="p">(</span><span class="n">ae_title</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_require_called_aet</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scu_supported_sop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the supported SCU classes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scu_supported_sop</span>

    <span class="nd">@scu_supported_sop</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">scu_supported_sop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sop_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the AE&#39;s supported SCU SOP classes.</span>

<span class="sd">        Examples of the `sop_list` items:</span>
<span class="sd">        - &#39;1.2.3.4&#39;</span>
<span class="sd">        - b&#39;1.2.3.4.5&#39;</span>
<span class="sd">        - pydicom.uid.UID(&#39;1.2.3&#39;)</span>
<span class="sd">        - pynetdicom3.sop_class.VerificationSOPClass</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sop_list : list of str, bytes, UID, pynetdicom3.sop_class.ServiceClass</span>
<span class="sd">            The supported SCU SOP classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scu_supported_sop</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sop_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;scu_supported_sop must be a list of SOP &quot;</span> \
                               <span class="s2">&quot;classes.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sop_class</span> <span class="ow">in</span> <span class="n">sop_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sop_class</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">sop_class</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">isclass</span><span class="p">(</span><span class="n">sop_class</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;UID&#39;</span> <span class="ow">in</span> <span class="n">sop_class</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">sop_class</span><span class="o">.</span><span class="n">UID</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sop_class</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">sop_class</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sop_uid</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_scu_supported_sop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sop_uid</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sop_list</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scu_supported_sop</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;No valid SCU SOP classes were supplied&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scp_supported_sop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the supported SCP classes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scp_supported_sop</span>

    <span class="nd">@scp_supported_sop</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">scp_supported_sop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sop_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the AE&#39;s supported SCP SOP classes.</span>

<span class="sd">        Examples of the `sop_list` items:</span>
<span class="sd">        - &#39;1.2.3.4&#39;</span>
<span class="sd">        - b&#39;1.2.3.4.5&#39;</span>
<span class="sd">        - pydicom.uid.UID(&#39;1.2.3&#39;)</span>
<span class="sd">        - pynetdicom3.sop_class.VerificationSOPClass</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sop_list : list of str, bytes, UID, pynetdicom3.sop_class.ServiceClass</span>
<span class="sd">            The supported SCP SOP classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scp_supported_sop</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sop_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;scp_supported_sop must be a list of SOP &quot;</span> \
                               <span class="s2">&quot;classes.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sop_class</span> <span class="ow">in</span> <span class="n">sop_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sop_class</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">sop_class</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sop_class</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">sop_class</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">isclass</span><span class="p">(</span><span class="n">sop_class</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;UID&#39;</span> <span class="ow">in</span> <span class="n">sop_class</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
                    <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">sop_class</span><span class="o">.</span><span class="n">UID</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sop_uid</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_scp_supported_sop</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sop_uid</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sop_list</span> <span class="o">!=</span> <span class="p">[]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scp_supported_sop</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;No valid SCP SOP classes were supplied&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transfer_syntaxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the supported transfer syntaxes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_syntaxes</span>

    <span class="nd">@transfer_syntaxes</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">transfer_syntaxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transfer_syntaxes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the supported transfer syntaxes.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_syntaxes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">transfer_syntaxes</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Transfer syntax must be a list of SOP classes.&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">syntax</span> <span class="ow">in</span> <span class="n">transfer_syntaxes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">syntax</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">syntax</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="n">sop_uid</span> <span class="o">=</span> <span class="n">UID</span><span class="p">(</span><span class="n">syntax</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Transfer syntax SOP class must be a &quot;</span>
                                 <span class="s2">&quot;UID str, UID bytes or UID.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">sop_uid</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Transfer syntax contained an &quot;</span>
                                 <span class="s2">&quot;invalid UID string&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">sop_uid</span><span class="o">.</span><span class="n">is_transfer_syntax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_syntaxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sop_uid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">LOGGER</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Attempted to add a non-transfer syntax &quot;</span>
                               <span class="s2">&quot;UID &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">syntax</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transfer_syntaxes</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Transfer syntax must be a list of SOP &quot;</span>
                             <span class="s2">&quot;Classes&quot;</span><span class="p">)</span>


    <span class="c1"># Association negotiation callbacks</span>
<div class="viewcode-block" id="ApplicationEntity.on_user_identity_negotiation"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_user_identity_negotiation">[docs]</a>    <span class="k">def</span> <span class="nf">on_user_identity_negotiation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id_type</span><span class="p">,</span> <span class="n">primary_field</span><span class="p">,</span>
                                     <span class="n">secondary_field</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a peer requests user identity negotiations.</span>

<span class="sd">        See PS3.7 Annex D.3.3.7.1</span>

<span class="sd">        Experimental and will definitely change</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id_type : int</span>
<span class="sd">            The User Identity Type value (1, 2, 3, 4).</span>
<span class="sd">        primary_field : bytes</span>
<span class="sd">            The value of the Primary Field</span>
<span class="sd">        secondary_field : bytes or None</span>
<span class="sd">            The value of the Secondary Field. Will be None unless the</span>
<span class="sd">            `user_id_type` is 2</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        response : bytes or None</span>
<span class="sd">            If `user_id_type` is :</span>
<span class="sd">              * 1 or 2, then return b&#39;&#39;.</span>
<span class="sd">              * 3 then return the Kerberos Server ticket.</span>
<span class="sd">              * 4 then return the SAML response.</span>

<span class="sd">            If the identity check fails then return None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>


    <span class="c1"># High-level DIMSE-C callbacks - user should implement these as required</span>
<div class="viewcode-block" id="ApplicationEntity.on_c_echo"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_echo">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_echo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-ECHO request is received.</span>

<span class="sd">        User implementation is not required for the C-ECHO service, but if you</span>
<span class="sd">        intend to do so it should be defined prior to calling AE.start() and</span>
<span class="sd">        must return either an int or a pydicom Dataset containing a (0000,0900)</span>
<span class="sd">        Status element with a valid C-ECHO status value.</span>

<span class="sd">        Called by pynetdicom3.sop_class.VerificationServiceClass.SCP()</span>
<span class="sd">        after receiving a C-ECHO request and prior to sending the response.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        Verification Service Class</span>

<span class="sd">        **Status**</span>

<span class="sd">        The DICOM Standard Part 7, Table 9.3-13 indicates that the returned</span>
<span class="sd">        status &quot;shall have a value of Success&quot;, however Section 9.1.5.1.4</span>
<span class="sd">        states that the status of the response may have any of the following</span>
<span class="sd">        values:</span>

<span class="sd">        Success</span>

<span class="sd">        - 0x000 - Success</span>

<span class="sd">        Failure</span>

<span class="sd">        - 0x0122 - SOP class not supported</span>
<span class="sd">        - 0x0210 - Duplicate invocation</span>
<span class="sd">        - 0x0212 - Mistyped argument</span>
<span class="sd">        - 0x0211 - Unrecognised operation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-ECHO message was sent under</span>
<span class="sd">            as a namedtuple with field names context_id, abstract_syntax and</span>
<span class="sd">            transfer_syntax.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            - &#39;requestor&#39; : {</span>
<span class="sd">               | &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">               | &#39;called_ae_title&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">               | &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">               | &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;acceptor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">              | &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;parameters&#39; : {</span>
<span class="sd">              | &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">              }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-ECHO response. Must be</span>
<span class="sd">            a valid C-ECHO/Verification Service Class status value as either an</span>
<span class="sd">            int or a Dataset object containing (at a minimum) a (0000,0900)</span>
<span class="sd">            &#39;Status&#39; element. If returning a Dataset object then it may also</span>
<span class="sd">            contain optional elements related to the Status (as in the DICOM</span>
<span class="sd">            Standard Part 7, Annex C).</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_echo</span>
<span class="sd">        dimse_primitives.C_ECHO</span>
<span class="sd">        sop_class.VerificationServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annex A</span>
<span class="sd">        DICOM Standard Part 7, Sections 9.1.5, 9.3.5 and Annex C</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># User implementation of on_c_echo is optional</span>
        <span class="k">return</span> <span class="mh">0x0000</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_store"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_store">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-STORE request is received.</span>

<span class="sd">        Must be defined by the user prior to calling AE.start() and must return</span>
<span class="sd">        either an int or a pydicom Dataset containing a (0000,0900) Status</span>
<span class="sd">        element with a valid C-STORE status value.</span>

<span class="sd">        Called by the corresponding pynetdicom3.sop_class Service Class&#39; SCP()</span>
<span class="sd">        method after receiving a C-STORE request and prior to sending the</span>
<span class="sd">        response.</span>

<span class="sd">        If the user is storing `dataset` in the DICOM File Format (as in the</span>
<span class="sd">        DICOM Standard Part 10, Section 7) then they are responsible for adding</span>
<span class="sd">        the DICOM File Meta Information.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        Storage Service Class</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>

<span class="sd">        - 0x0000 - Success</span>

<span class="sd">        Warning</span>

<span class="sd">        - 0xB000 - Coercion of data elements</span>
<span class="sd">        - 0xB006 - Elements discarded</span>
<span class="sd">        - 0xB007 - Dataset does not match SOP class</span>

<span class="sd">        Failure</span>

<span class="sd">        - 0x0117 - Invalid SOP instance</span>
<span class="sd">        - 0x0122 - SOP class not supported</span>
<span class="sd">        - 0x0124 - Not authorised</span>
<span class="sd">        - 0x0210 - Duplicate invocation</span>
<span class="sd">        - 0x0211 - Unrecognised operation</span>
<span class="sd">        - 0x0212 - Mistyped argument</span>
<span class="sd">        - 0xA700 to 0xA7FF - Out of resources</span>
<span class="sd">        - 0xA900 to 0xA9FF - Dataset does not match SOP class</span>
<span class="sd">        - 0xC000 to 0xCFFF - Cannot understand</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM dataset sent by the peer in the C-STORE request.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-STORE message was sent under</span>
<span class="sd">            as a namedtuple with field names context_id, abstract_syntax and</span>
<span class="sd">            transfer_syntax.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            - &#39;requestor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">              | &#39;called_ae_title&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">              | &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;acceptor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">              | &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;parameters&#39; : {</span>
<span class="sd">              | &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">              | &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              | &#39;originator_aet&#39; : bytes or None, the move originator&#39;s AE title</span>
<span class="sd">              | &#39;originator_message_id&#39; : int or None, the move originator&#39;s message ID</span>
<span class="sd">              }</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-STORE response. Must be</span>
<span class="sd">            a valid C-STORE status value for the applicable Service Class as</span>
<span class="sd">            either an int or a Dataset object containing (at a minimum) a</span>
<span class="sd">            (0000,0900) &#39;Status&#39; element. If returning a Dataset object then it</span>
<span class="sd">            may also contain optional elements related to the Status (as in the</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the callback has not been implemented by the user</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_store</span>
<span class="sd">        dimse_primitives.C_STORE</span>
<span class="sd">        sop_class.StorageServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes B, AA, FF and GG</span>
<span class="sd">        DICOM Standard Part 7, Sections 9.1.1, 9.3.1 and Annex C</span>
<span class="sd">        DICOM Standard Part 10, Section 7</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_store &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_find"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_find">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-FIND request is received.</span>

<span class="sd">        Must be defined by the user prior to calling AE.start() and must yield</span>
<span class="sd">        status (as either an int or pydicom Dataset containing a (0000,0900)</span>
<span class="sd">        Status element) and an Identifier dataset. In addition, the</span>
<span class="sd">        AE.on_c_find_cancel() callback must also be defined.</span>

<span class="sd">        Called by the corresponding pynetdicom3.sop_class Service Class&#39; SCP()</span>
<span class="sd">        method after receiving a C-FIND request and prior to sending the</span>
<span class="sd">        response.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        Query/Retrieve Service Class</span>
<span class="sd">        Basic Worklist Management Service</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>

<span class="sd">        - 0x0000 - Success</span>

<span class="sd">        Failure</span>

<span class="sd">        - 0xA700 - Out of resources</span>
<span class="sd">        - 0xA900 - Identifier does not match SOP class</span>
<span class="sd">        - 0xC000 to 0xCFFF - Unable to process</span>

<span class="sd">        Cancel</span>

<span class="sd">        - 0xFE00 - Matching terminated due to Cancel request</span>

<span class="sd">        Pending</span>

<span class="sd">        - 0xFF00 - Matches are continuing: current match is supplied and any</span>
<span class="sd">          Optional Keys were supported in the same manner as Required Keys</span>
<span class="sd">        - 0xFF01 - Matches are continuing: warning that one or more Optional</span>
<span class="sd">          Keys were not supported for existence and/or matching for this</span>
<span class="sd">          Identifier</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM Identifier dataset sent by the peer in the C-FIND</span>
<span class="sd">            request.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-FIND message was sent under</span>
<span class="sd">            as a namedtuple with field names context_id, abstract_syntax and</span>
<span class="sd">            transfer_syntax.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            - &#39;requestor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">              | &#39;called_ae_title&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">              | &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;acceptor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">              | &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;parameters&#39; : {</span>
<span class="sd">              | &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">              | &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              }</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-FIND response. Must be</span>
<span class="sd">            a valid C-FIND status vuale for the applicable Service Class as</span>
<span class="sd">            either an int or a Dataset object containing (at a minimum) a</span>
<span class="sd">            (0000,0900) &#39;Status&#39; element. If returning a Dataset object then it</span>
<span class="sd">            may also contain optional elements related to the Status (as in</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status is &#39;Pending&#39; then the Identifier dataset for a</span>
<span class="sd">            matching SOP Instance. The exact requirements for the C-FIND</span>
<span class="sd">            response Identifier dataset are Service Class specific (see the</span>
<span class="sd">            DICOM Standard, Part 4).</span>

<span class="sd">            If the status is &#39;Failure&#39; or &#39;Cancel&#39; then yield None.</span>

<span class="sd">            If the status is &#39;Success&#39; then yield None, however yielding a</span>
<span class="sd">            final &#39;Success&#39; status is not required and will be ignored if</span>
<span class="sd">            necessary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_find</span>
<span class="sd">        dimse_primitives.C_FIND</span>
<span class="sd">        sop_class.QueryRetrieveFindServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes C, K, Q, U, V, X, BB, CC and HH</span>
<span class="sd">        DICOM Standard Part 7, Sections 9.1.2, 9.3.2 and Annex C</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_find &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_find_cancel"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_find_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_find_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-FIND-CANCEL request is received.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if you want to stop the C-FIND operation, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_c_find_cancel function prior to &quot;</span>
                                  <span class="s2">&quot;calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_get"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_get">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-GET request is received.</span>

<span class="sd">        Must be defined by the user prior to calling AE.start() and must yield</span>
<span class="sd">        a int containing the total number of C-STORE sub-operations, then yield</span>
<span class="sd">        (status, dataset) pairs.</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        Query/Retrieve Service Class</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>

<span class="sd">        - 0x0000 - Sub-operations complete, no failures or warnings</span>

<span class="sd">        Failure</span>

<span class="sd">        - 0xA701 - Out of resources: unable to calculate the number of matches</span>
<span class="sd">        - 0xA702 - Out of resources: unable to perform sub-operations</span>
<span class="sd">        - 0xA900 - Identifier does not match SOP class</span>
<span class="sd">        - 0xC000 to 0xCFFF - Unable to process</span>

<span class="sd">        Cancel</span>

<span class="sd">        - 0xFE00 - Sub-operations terminated due to Cancel request</span>

<span class="sd">        Warning</span>

<span class="sd">        - 0xB000 - Sub-operations complete, one or more failures or warnings</span>

<span class="sd">        Pending</span>

<span class="sd">        - 0xFF00 - Matches are continuing - Current Match is supplied and any</span>
<span class="sd">          Optional Keys were supported in the same manner as Required Keys</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM Identifier dataset sent by the peer in the C-GET request.</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-GET message was sent under</span>
<span class="sd">            as a namedtuple with field names context_id, abstract_syntax and</span>
<span class="sd">            transfer_syntax.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            - &#39;requestor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">              | &#39;called_ae_title&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">              | &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;acceptor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">              | &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;parameters&#39; : {</span>
<span class="sd">              | &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">              | &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              }</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        int</span>
<span class="sd">            The first yielded value should be the total number of C-STORE</span>
<span class="sd">            sub-operations necessary to complete the C-GET operation. In other</span>
<span class="sd">            words, this is the number of matching SOP Instances to be sent to</span>
<span class="sd">            the peer.</span>
<span class="sd">        status : pydicom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-GET response. Must be a</span>
<span class="sd">            valid C-GET status value for the applicable Service Class as either</span>
<span class="sd">            an int or a Dataset object containing (at a minimum) a (0000,0900)</span>
<span class="sd">            &#39;Status&#39; element. If returning a Dataset object then it may also</span>
<span class="sd">            contain optional elements related to the Status (as in DICOM</span>
<span class="sd">            Standard Part 7, Annex C).</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status is &#39;Pending&#39; then yield the dataset to send to the</span>
<span class="sd">            peer via a C-STORE sub-operation over the current association.</span>

<span class="sd">            If the status is &#39;Failed&#39;, &#39;Warning&#39; or &#39;Cancel&#39; then yield a</span>
<span class="sd">            Dataset with a (0008,0058) &#39;Failed SOP Instance UID List&#39; element</span>
<span class="sd">            containing a list of the C-STORE sub-operation SOP Instance UIDs</span>
<span class="sd">            for which the C-GET operation has failed.</span>

<span class="sd">            If the status is &#39;Success&#39; then yield None, although yielding a</span>
<span class="sd">            final &#39;Success&#39; status is not required and will be ignored if</span>
<span class="sd">            necessary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_get</span>
<span class="sd">        dimse_primitives.C_GET</span>
<span class="sd">        sop_class.QueryRetrieveGetServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes C, U, X, Y, Z, BB and HH</span>
<span class="sd">        DICOM Standard Part 7, Sections 9.1.3, 9.3.3 and Annex C</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_get &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_get_cancel"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_get_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_get_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-GET-CANCEL request is received.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_c_get_cancel function prior to &quot;</span>
                                  <span class="s2">&quot;calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_move"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_move">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">move_aet</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-MOVE request is received.</span>

<span class="sd">        Must be defined by the user prior to calling AE.start().</span>

<span class="sd">        The first yield should be the (addr, port) of the move destination, the</span>
<span class="sd">        second yield the number of required C-STORE sub-operations, and the</span>
<span class="sd">        remaining yields the (status, dataset) pairs.</span>

<span class="sd">        Matching SOP Instances will be sent to the peer AE with AE title</span>
<span class="sd">        `move_aet` over a new association. If `move_aet` is unknown then the</span>
<span class="sd">        SCP will send a response with a &#39;Failure&#39; status of 0xA801 (move</span>
<span class="sd">        destination unknown).</span>

<span class="sd">        **Supported Service Classes**</span>

<span class="sd">        Query/Retrieve Service Class</span>

<span class="sd">        **Status**</span>

<span class="sd">        Success</span>

<span class="sd">        - 0x0000 - Sub-operations complete, no failures</span>

<span class="sd">        Pending</span>

<span class="sd">        - 0xFF00 - Sub-operations are continuing</span>

<span class="sd">        Cancel</span>

<span class="sd">        - 0xFE00 - Sub-operations terminated due to Cancel indication</span>

<span class="sd">        Failure</span>

<span class="sd">        - 0x0122 - SOP class not supported</span>
<span class="sd">        - 0x0124 - Not authorised</span>
<span class="sd">        - 0x0210 - Duplicate invocation</span>
<span class="sd">        - 0x0211 - Unrecognised operation</span>
<span class="sd">        - 0x0212 - Mistyped argument</span>
<span class="sd">        - 0xA701 - Out of resources: unable to calculate number of matches</span>
<span class="sd">        - 0xA702 - Out of resources: unable to perform sub-operations</span>
<span class="sd">        - 0xA801 - Move destination unknown</span>
<span class="sd">        - 0xA900 - Identifier does not match SOP class</span>
<span class="sd">        - 0xC000 to 0xCFFF - Unable to process</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dataset : pydicom.dataset.Dataset</span>
<span class="sd">            The DICOM Identifier dataset sent by the peer in the C-MOVE request.</span>
<span class="sd">        move_aet : bytes</span>
<span class="sd">            The destination AE title that matching SOP Instances will be sent</span>
<span class="sd">            to using C-STORE sub-operations. `move_aet` will be a correctly</span>
<span class="sd">            formatted AE title (16 chars, with trailing spaces as padding).</span>
<span class="sd">        context : presentation.PresentationContextTuple</span>
<span class="sd">            The presentation context that the C-MOVE message was sent under</span>
<span class="sd">            as a namedtuple with field names context_id, abstract_syntax and</span>
<span class="sd">            transfer_syntax.</span>
<span class="sd">        info : dict</span>
<span class="sd">            A dict containing information about the current association, with</span>
<span class="sd">            the keys:</span>

<span class="sd">            - &#39;requestor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the requestor&#39;s calling AE title</span>
<span class="sd">              | &#39;called_ae_title&#39; : bytes, the requestor&#39;s called AE title</span>
<span class="sd">              | &#39;address&#39; : str, the requestor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the requestor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;acceptor&#39; : {</span>
<span class="sd">              | &#39;ae_title&#39; : bytes, the acceptor&#39;s AE title</span>
<span class="sd">              | &#39;address&#39; : str, the acceptor&#39;s IP address</span>
<span class="sd">              | &#39;port&#39; : int, the acceptor&#39;s port number</span>
<span class="sd">              }</span>
<span class="sd">            - &#39;parameters&#39; : {</span>
<span class="sd">              | &#39;message_id&#39; : int, the DIMSE message ID</span>
<span class="sd">              | &#39;priority&#39; : int, the requested operation priority</span>
<span class="sd">              }</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        addr, port : str, int or None, None</span>
<span class="sd">            The first yield should be the TCP/IP address and port number of the</span>
<span class="sd">            destination AE (if known) or (None, None) if unknown. If (None,</span>
<span class="sd">            None) is yielded then the SCP will send a C-MOVE response with a</span>
<span class="sd">            &#39;Failure&#39; Status of 0xA801 (move destination unknown), in which</span>
<span class="sd">            case nothing more needs to be yielded.</span>
<span class="sd">        int</span>
<span class="sd">            The second yield should be the number of C-STORE sub-operations</span>
<span class="sd">            required to complete the C-MOVE operation. In other words, this is</span>
<span class="sd">            the number of matching SOP Instances to be sent to the peer.</span>
<span class="sd">        status : pydiom.dataset.Dataset or int</span>
<span class="sd">            The status returned to the peer AE in the C-MOVE response. Must be</span>
<span class="sd">            a valid C-MOVE status value for the applicable Service Class as</span>
<span class="sd">            either an int or a Dataset object containing (at a minimum) a</span>
<span class="sd">            (0000,0900) &#39;Status&#39; element. If returning a Dataset object then it</span>
<span class="sd">            may also contain optional elements related to the Status (as in</span>
<span class="sd">            DICOM Standard Part 7, Annex C).</span>
<span class="sd">        dataset : pydicom.dataset.Dataset or None</span>
<span class="sd">            If the status is &#39;Pending&#39; then yield the dataset to send to the</span>
<span class="sd">            peer via a C-STORE sub-operation over a new association.</span>

<span class="sd">            If the status is &#39;Failed&#39;, &#39;Warning&#39; or &#39;Cancel&#39; then yield a</span>
<span class="sd">            Dataset with a (0008,0058) &#39;Failed SOP Instance UID List&#39; element</span>
<span class="sd">            containing the list of the C-STORE sub-operation SOP Instance UIDs</span>
<span class="sd">            for which the C-MOVE operation has failed.</span>

<span class="sd">            If the status is &#39;Success&#39; then yield None, although yielding a</span>
<span class="sd">            final &#39;Success&#39; status is not required and will be ignored if</span>
<span class="sd">            necessary.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        association.Association.send_c_move</span>
<span class="sd">        dimse_primitives.C_MOVE</span>
<span class="sd">        sop_class.QueryRetrieveMoveServiceClass</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes C, U, X, Y, BB and HH</span>
<span class="sd">        DICOM Standard Part 7, Sections 9.1.4, 9.3.4 and Annex C</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the AE.on_c_move &quot;</span>
                                  <span class="s2">&quot;function prior to calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_c_move_cancel"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_c_move_cancel">[docs]</a>    <span class="k">def</span> <span class="nf">on_c_move_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a C-MOVE-CANCEL request is received.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_c_move_cancel function prior to &quot;</span>
                                  <span class="s2">&quot;calling AE.start()&quot;</span><span class="p">)</span></div>


    <span class="c1"># High-level DIMSE-N callbacks - user should implement these as required</span>
<div class="viewcode-block" id="ApplicationEntity.on_n_event_report"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_n_event_report">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_event_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-EVENT-REPORT is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, J, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_event_report function prior to &quot;</span>
                                  <span class="s2">&quot;calling AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_get"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_n_get">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-GET is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, S, CC, DD and EE</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_get function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_set"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_n_set">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-SET is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_set function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_action"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_n_action">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-ACTION is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes H, J, P, S, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_action function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_create"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_n_create">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-CREATE is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes F, H, R, S, CC and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_create function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_n_delete"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_n_delete">[docs]</a>    <span class="k">def</span> <span class="nf">on_n_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when a N-DELETE is received.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        DICOM Standard Part 4, Annexes H and DD</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;User must implement the &quot;</span>
                                  <span class="s2">&quot;AE.on_n_delete function prior to calling &quot;</span>
                                  <span class="s2">&quot;AE.start()&quot;</span><span class="p">)</span></div>


    <span class="c1"># Communication related callbacks</span>
<div class="viewcode-block" id="ApplicationEntity.on_receive_connection"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_receive_connection">[docs]</a>    <span class="k">def</span> <span class="nf">on_receive_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for a connection is received.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_make_connection"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_make_connection">[docs]</a>    <span class="k">def</span> <span class="nf">on_make_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for a connection is made.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


    <span class="c1"># High-level Association related callbacks</span>
<div class="viewcode-block" id="ApplicationEntity.on_association_requested"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_association_requested">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_requested</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for an association is requested.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_accepted"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_association_accepted">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_accepted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is accepted.</span>

<span class="sd">        Placeholder for a function callback. Function will be called</span>
<span class="sd">        when an association attempt is accepted by either the local or peer AE</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        primitive</span>
<span class="sd">            The A-ASSOCIATE-AC PDU instance received from the peer AE</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_rejected"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_association_rejected">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_rejected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is rejected.</span>

<span class="sd">        Placeholder for a function callback. Function will be called</span>
<span class="sd">        when an association attempt is rejected by a peer AE</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        associate_rq_pdu : pynetdicom3.pdu.A_ASSOCIATE_RJ</span>
<span class="sd">            The A-ASSOCIATE-RJ PDU instance received from the peer AE</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_released"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_association_released">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_released</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is released.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="ApplicationEntity.on_association_aborted"><a class="viewcode-back" href="../../api.html#pynetdicom3.applicationentity.ApplicationEntity.on_association_aborted">[docs]</a>    <span class="k">def</span> <span class="nf">on_association_aborted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback for when an association is aborted.&quot;&quot;&quot;</span>
        <span class="c1"># FIXME: Need to standardise callback parameters for A-ABORT</span>
        <span class="k">pass</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, pynetdicom3 contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.9.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>